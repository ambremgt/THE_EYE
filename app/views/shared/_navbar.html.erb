<div class="navbar navbar-expand-lg navbar-light navbar-lewagon fixed-top">
  <%= link_to "/", class: "navbar-brand text-white" do %>
    <% end %>


  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>


  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <% if user_signed_in? %>
        <li><p style="color: green">Hello, <%= current_user.first_name  %></p></li>


        <li class="nav-item" id="user-channel" data-user-id="<%= current_user.id %>">
          <%= link_to "Add shotlist", "/shotlists/new", class: "btn nav-link-white" %></li>
          <li class="nav-item" id="dashboard-link">
            <%= link_to "Dashboard", "/dashboard", class: "btn nav-link-transparent" %>

          </li>

            <div id="notif-counter" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color:green"><%= current_user.unread_messages_hash.values.sum %></div>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="notif-counter">
              <% current_user.unread_messages_hash.select { |k, v| v != 0 }.each do |k, v| %>
                <% selected_chatroom = Chatroom.find(k) %>
                <% other_chatter = current_user.other_chatter?(selected_chatroom) %>
                <%= link_to chatroom_path(k) do %>
                  <% if other_chatter.present? %>
                    <div><%= other_chatter.first_name %></div>
                  <% end %>
                  <div>Messages non lus : <%= v %></div>
                  <div><%= selected_chatroom.messages.last.content %></div>
                <% end %>
              <% end %>
            </div>



        <li class="nav-item">
          <%= link_to "Add a project", "/shotlists/new", class: "btn nav-link-white" %></li>
          <li class="nav-item">
          <%= link_to "Dashboard", "/dashboard", class: "btn nav-link-transparent" %></li>
          <li class="nav-item">
          <%= link_to "Log out", destroy_user_session_path, method: :delete, class: "btn nav-link-transparent" %></li>
      <% else %>
        <li class="nav-item" style="margin-right: 20px;">
          <%= link_to "Find a filmmaker", "/", class: "btn nav-link-white" %></li>
          <li class="nav-item">
          <%= link_to "Login", new_user_session_path, class: "btn nav-link-transparent" %></li>
        </li>
      <% end %>
    </ul>
  </div>
</div>
